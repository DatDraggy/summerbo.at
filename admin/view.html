<?php
session_start();
require_once(__DIR__ . '/../backend/funcs.php');
require_once(__DIR__ . '/../backend/config.php');
if (!empty($_SESSION['userId'])) {
  $requesterUserId = $_SESSION['userId'];
  $dbConnection = buildDatabaseConnection($config);

  if (checkRegValid($requesterUserId)) {
    $rank = getUserRank($_SESSION['userId']);
    if ($rank > 0) {
      $userId = $_GET['id'];
      if ($_GET['type'] === 'reg') {
        $details = getRegDetails($userId);
        echo '<pre>'.print_r($details, true).'</pre>';
      }
    }
  }
  die();
}
else {
  if (isset($_COOKIE[session_name()])) {
    setcookie(session_name(), '', time() - 3600, '/');
  }
  session_destroy();
  header('Location: ../login.html');
}
?>
